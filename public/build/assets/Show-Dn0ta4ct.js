import{r as d,j as e,m as g,K as q,S as C,L as O,$ as j}from"./app-kJd0IbDP.js";import{a as I,A as S,C as A}from"./AuthenticatedLayout-W4SJNb0d.js";import{G as k}from"./iconBase-Brf-aoCc.js";function E({images:c}){var l;const[s,u]=d.useState(0);return e.jsxs("div",{className:"flex flex-col md:flex-row h-full gap-4",children:[e.jsx("div",{className:"flex md:flex-col gap-2 overflow-x-auto md:overflow-x-visible md:overflow-y-auto py-2 px-1 md:px-0",children:c.map((x,n)=>e.jsx("button",{onClick:()=>u(n),className:`flex-shrink-0 w-14 h-14 border-2 rounded-md overflow-hidden ${n===s?"border-blue-500":"border-transparent"}`,children:e.jsx("img",{src:x.thumb,alt:"",className:"w-full h-full object-cover"})},x.id))}),e.jsx("div",{className:"flex-1 bg-gray-50 rounded-lg overflow-hidden min-h-[300px] md:min-h-0",children:e.jsx("img",{src:((l=c[s])==null?void 0:l.large)||"",alt:"",className:"w-full h-full object-contain"})})]})}function L(c){return k({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 24C0 10.7 10.7 0 24 0L69.5 0c22 0 41.5 12.8 50.6 32l411 0c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3l-288.5 0 5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5L488 336c13.3 0 24 10.7 24 24s-10.7 24-24 24l-288.3 0c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5L24 48C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96zM252 160c0 11 9 20 20 20l44 0 0 44c0 11 9 20 20 20s20-9 20-20l0-44 44 0c11 0 20-9 20-20s-9-20-20-20l-44 0 0-44c0-11-9-20-20-20s-20 9-20 20l0 44-44 0c-11 0-20 9-20 20z"},child:[]}]})(c)}function F({appName:c,product:s,variationOptions:u}){var f;const l=g({option_ids:{},quantity:1,price:null}),{url:x}=q(),[n,v]=d.useState([]),h=d.useMemo(()=>{for(let t in n){const r=n[t];if(r.images.length>0)return r.images}return s.images},[s,n]),m=d.useMemo(()=>{const t=Object.values(n).map(r=>r.id).sort();for(let r of s.variations){const a=r.variation_type_option_ids.sort();if(I(t,a))return{price:r.price,quantity:r.quantity===null?Number.MAX_VALUE:r.quantity}}return{price:s.price,quantity:s.quantity}},[s,n]);d.useEffect(()=>{for(let t of s.variationTypes){const r=u[t.id];p(t.id,t.options.find(a=>a.id==r)||t.options[0],!1)}},[]);const b=t=>Object.fromEntries(Object.entries(t).map(([r,a])=>[r,a.id])),p=(t,r,a=!0)=>{v(o=>{const i={...o,[t]:r};return a&&C.get(x,{options:b(i)},{preserveScroll:!0,preserveState:!0}),i})},{data:M,setData:T}=g({quantity:1}),y=t=>{const r=parseInt(t.target.value);l.setData("quantity",r)},N=()=>{l.post(route("cart.store",s.id),{preserveScroll:!0,preserveState:!0,onError:t=>{console.log(t)}})},w=()=>s.variationTypes.map((t,r)=>e.jsxs("div",{className:"flex flex-col mb-4",children:[e.jsx("b",{className:"mb-2",children:t.name}),t.type==="Image"&&e.jsx("div",{className:"flex gap-2",children:t.options.map(a=>{var o,i;return e.jsx("div",{onClick:()=>p(t.id,a),className:`cursor-pointer border rounded p-1 ${((o=n[t.id])==null?void 0:o.id)===a.id?"border-2 border-violet-600":"border-gray-300"}`,children:((i=a.images)==null?void 0:i.length)>0&&e.jsx("img",{src:a.images[0].thumb,alt:a.name,className:"w-[50px] h-[50px] object-cover rounded"})},a.id)})}),t.type==="Radio"&&e.jsx("div",{className:"flex join",children:t.options.map(a=>{var o,i;return e.jsx("input",{onChange:()=>p(t.id,a),className:`joint-item btn rounded-md ${((o=n[t.id])==null?void 0:o.id)===a.id?"primary":""}`,type:"radio",value:a.id,checked:((i=n[t.id])==null?void 0:i.id)===a.id,name:"variation_type_"+t.id,"aria-label":a.name},a.id)})})]},t.id)),_=()=>e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"quantity",className:"text-sm font-medium",children:"Qty:"}),e.jsx("select",{id:"quantity",value:l.data.quantity,onChange:y,className:"text-sm px-2 py-1 rounded-md border border-gray-300 focus:outline-none focus:ring-1 focus:ring-purple-500",children:Array.from({length:m.quantity},(t,r)=>r+1).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("button",{onClick:N,className:"bg-purple-800 hover:bg-purple-700 text-white text-sm font-medium px-3 py-2 rounded-md transition flex items-center gap-1.5 shadow-sm",children:[e.jsx(L,{className:"w-4 h-4"}),"Add to Cart"]})]});return d.useEffect(()=>{const t=Object.fromEntries(Object.entries(n).map(([r,a])=>[r,a.id]));l.setData("option_ids",t),console.log("selected option",n)},[n]),e.jsxs(S,{children:[e.jsxs(O,{children:[e.jsx("title",{children:s.title}),e.jsx("meta",{name:"title",content:s.meta_title||s.title}),e.jsx("meta",{name:"description",content:s.meta_description}),e.jsx("link",{rel:"canonical",href:route("product.show",s.slug)}),e.jsx("meta",{property:"og:title",content:s.title}),e.jsx("meta",{property:"og:description",content:s.meta_description}),e.jsx("meta",{property:"og:image",content:(f=h[0])==null?void 0:f.small}),e.jsx("meta",{property:"og:url",content:route("product.show",s.slug)}),e.jsx("meta",{property:"og:type",content:"product"}),e.jsx("meta",{property:"og:site_name",content:c})]}),e.jsx("div",{className:"container mx-auto p-4 md:p-8 min-h-[calc(100vh-150px)]",children:e.jsxs("div",{className:"grid gap-8 grid-cols-1 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 lg:sticky lg:top-4 lg:self-start",children:e.jsx(E,{images:h})}),e.jsxs("div",{className:"lg:col-span-6 lg:overflow-y-auto scrollbar-hide",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.title}),e.jsxs("p",{className:"mb-4",children:["by"," ",e.jsx(j,{href:route("vendor.profile",s.user.store_name),className:"hover:underline",children:s.user.name})," ","in"," ",e.jsx(j,{href:route("product.byDepartment",s.department.slug),className:"hover:underline",children:s.department.name})]}),e.jsx("div",{className:"text-3xl font-semibold mb-6",children:e.jsx(A,{amount:m.price})}),s.variationTypes.length>0&&e.jsx("div",{children:w()}),m.quantity!=null&&m.quantity<10&&e.jsxs("div",{className:"text-red-600 my-4",children:["Only ",m.quantity," left"]}),e.jsx("div",{className:"my-6 sticky bottom-0 bg-white py-4 z-10 lg:static lg:bg-transparent lg:py-0",children:_()}),e.jsxs("div",{className:"product-description pb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"About the Item"}),e.jsx("div",{className:"prose max-w-none text-gray-700 ck-content-output",dangerouslySetInnerHTML:{__html:s.description}})]})]})]})})]})}export{F as default};
