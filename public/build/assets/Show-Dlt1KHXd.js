import{r as o,j as e,m as h,K as N,S as w,L as q}from"./app-9WHcwt9K.js";import{a as C,A as O,C as I}from"./AuthenticatedLayout-D8nTQdBA.js";import{G as S}from"./iconBase-CLculi1J.js";function _({images:i}){var u;const[m,l]=o.useState(0);return e.jsxs("div",{className:"flex flex-col md:flex-row h-full gap-4",children:[e.jsx("div",{className:"flex md:flex-col gap-2 overflow-x-auto md:overflow-x-visible md:overflow-y-auto py-2 px-1 md:px-0",children:i.map((r,x)=>e.jsx("button",{onClick:()=>l(x),className:`flex-shrink-0 w-14 h-14 border-2 rounded-md overflow-hidden ${x===m?"border-blue-500":"border-transparent"}`,children:e.jsx("img",{src:r.thumb,alt:"",className:"w-full h-full object-cover"})},r.id))}),e.jsx("div",{className:"flex-1 bg-gray-50 rounded-lg overflow-hidden min-h-[300px] md:min-h-0",children:e.jsx("img",{src:((u=i[m])==null?void 0:u.large)||"",alt:"",className:"w-full h-full object-contain"})})]})}function A(i){return S({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 24C0 10.7 10.7 0 24 0L69.5 0c22 0 41.5 12.8 50.6 32l411 0c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3l-288.5 0 5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5L488 336c13.3 0 24 10.7 24 24s-10.7 24-24 24l-288.3 0c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5L24 48C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96zM252 160c0 11 9 20 20 20l44 0 0 44c0 11 9 20 20 20s20-9 20-20l0-44 44 0c11 0 20-9 20-20s-9-20-20-20l-44 0 0-44c0-11-9-20-20-20s-20 9-20 20l0 44-44 0c-11 0-20 9-20 20z"},child:[]}]})(i)}function z({product:i,variationOptions:m}){const l=h({option_ids:{},quantity:1,price:null}),{url:u}=N(),[r,x]=o.useState([]),f=o.useMemo(()=>{for(let t in r){const s=r[t];if(s.images.length>0)return s.images}return i.images},[i,r]),c=o.useMemo(()=>{const t=Object.values(r).map(s=>s.id).sort();for(let s of i.variations){const a=s.variation_type_option_ids.sort();if(C(t,a))return{price:s.price,quantity:s.quantity===null?Number.MAX_VALUE:s.quantity}}return{price:i.price,quantity:i.quantity}},[i,r]);o.useEffect(()=>{for(let t of i.variationTypes){const s=m[t.id];p(t.id,t.options.find(a=>a.id==s)||t.options[0],!1)}},[]);const g=t=>Object.fromEntries(Object.entries(t).map(([s,a])=>[s,a.id])),p=(t,s,a=!0)=>{x(n=>{const d={...n,[t]:s};return a&&w.get(u,{options:g(d)},{preserveScroll:!0,preserveState:!0}),d})},{data:E,setData:L}=h({quantity:1}),v=t=>{const s=parseInt(t.target.value);l.setData("quantity",s)},j=()=>{l.post(route("cart.store",i.id),{preserveScroll:!0,preserveState:!0,onError:t=>{console.log(t)}})},b=()=>i.variationTypes.map((t,s)=>e.jsxs("div",{className:"flex flex-col mb-4",children:[e.jsx("b",{className:"mb-2",children:t.name}),t.type==="Image"&&e.jsx("div",{className:"flex gap-2",children:t.options.map(a=>{var n,d;return e.jsx("div",{onClick:()=>p(t.id,a),className:`cursor-pointer border rounded p-1 ${((n=r[t.id])==null?void 0:n.id)===a.id?"border-2 border-violet-600":"border-gray-300"}`,children:((d=a.images)==null?void 0:d.length)>0&&e.jsx("img",{src:a.images[0].thumb,alt:a.name,className:"w-[50px] h-[50px] object-cover rounded"})},a.id)})}),t.type==="Radio"&&e.jsx("div",{className:"flex join",children:t.options.map(a=>{var n;return e.jsx("input",{onChange:()=>p(t.id,a),className:"joint-item btn",type:"radio",value:a.id,checked:((n=r[t.id])==null?void 0:n.id)===a.id,name:"variation_type_"+t.id,"aria-label":a.name},a.id)})})]},t.id)),y=()=>e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"quantity",className:"text-sm font-medium",children:"Qty:"}),e.jsx("select",{id:"quantity",value:l.data.quantity,onChange:v,className:"text-sm px-2 py-1 rounded-md border border-gray-300 focus:outline-none focus:ring-1 focus:ring-purple-500",children:Array.from({length:c.quantity},(t,s)=>s+1).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("button",{onClick:j,className:"bg-purple-800 hover:bg-purple-700 text-white text-sm font-medium px-3 py-2 rounded-md transition flex items-center gap-1.5 shadow-sm",children:[e.jsx(A,{className:"w-4 h-4"}),"Add to Cart"]})]});return o.useEffect(()=>{const t=Object.fromEntries(Object.entries(r).map(([s,a])=>[s,a.id]));l.setData("option_ids",t)},[r]),e.jsxs(O,{children:[e.jsx(q,{title:i.title}),e.jsx("div",{className:"container mx-auto p-4 md:p-8 min-h-[calc(100vh-150px)]",children:e.jsxs("div",{className:"grid gap-8 grid-cols-1 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-6 lg:sticky lg:top-4 lg:self-start",children:e.jsx(_,{images:f})}),e.jsxs("div",{className:"lg:col-span-6 lg:overflow-y-auto scrollbar-hide",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:i.title}),e.jsx("div",{className:"text-3xl font-semibold mb-6",children:e.jsx(I,{amount:c.price})}),i.variationTypes.length>0&&e.jsx("div",{children:b()}),c.quantity!=null&&c.quantity<10&&e.jsxs("div",{className:"text-red-600 my-4",children:["Only ",c.quantity," left"]}),e.jsx("div",{className:"my-6 sticky bottom-0 bg-white py-4 z-10 lg:static lg:bg-transparent lg:py-0",children:y()}),e.jsxs("div",{className:"product-description pb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"About the Item"}),e.jsx("div",{className:"prose max-w-none text-gray-700 ck-content-output",dangerouslySetInnerHTML:{__html:i.description}})]})]})]})})]})}export{z as default};
